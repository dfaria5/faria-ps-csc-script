POWERSHELL SCRIPT TODO:


# WIN10/11
[DONE] CONTROL PANEL > PROGRAMS AND FEATURES > TURN WINDOWS FEATURES ON OR OFF > LEGACY COMPONENTS > DIRECTPLAY
FILE EXPLORER > SETTINGS > VIEW > CHECK [SHOW LIBRARIES]
C: DRIVER > PROPERTIES > CHECK [ALLOW FILES ON THIS DRIVE TO HAVE CONTENTS INDEXED IN ADDITION TO FILE PROPERTIES] (PRESS "Ignore All" IF FILE NOT POSSIBLE)

# WIN10
SETTINGS > PERSONALISATION
	BACKGROUND > BACKGROUND = PICTURE
	LOCK SCREEN > BACKGROUND = PICTURE
	START > > FOLDERS = ALL

# WIN11
SETTINGS > SYSTEM >
	DISPLAY > GRAPHICS > [OPTMIZATION WINDOWED GAMES] = ON
	NOTIFICATIONS > [ADITIONAL SETTINGS] = UNCHECK ALL
	STORAGE > [STORAGE SENSE] = OFF
	[NEARBY SHARING] = (user choice)
	CLIPBOARD > [CLIPBOARD HISTORY] = ON
SETTINGS > BLUETOOTH & DEVICES >
	MOUSE > [ENHANCE POINTER PRECISION] = OFF
	AUTOPLAY > [USE AUTOPLAY FOR ALL MEDIA AND DEVICES] = OFF > [REMOVABLE DRIVE] & [MEMORY CARD] & REST... = TAKE NO ACTION
SETTINGS > PERSONALISATION >
	BACKGROUND > BACKGROUND = PICTURE
	LOCK SCREEN > BACKGROUND = PICTURE > [GET FUN FACTS, TIPS, TRICKS AND MORE ON YOUR LOCK SCREEN] = OFF > [WIDGETS] & [SUGGEST WIDGETS FOR YOUR LOCK SCREEN] = OFF
	TEXT INPUT > [CUSTOMISE COPILOT KEY ON KEYBOARD] = NONE SELECTED
	START > [SHOW ALL PINS BY DEFAULT] = ON > [SHOW THE MOST USED APPS] & [SHOW RECOMMENDED FILES IN START, RECENT FILES IN FILES EXPLORER, AND ITEMS IN JUMP LISTS] = OFF > FOLDERS = ALL CHECKED ON
	DEVICE USAGE > ALL UNCHECKED OFF
SETTINGS > APPS >
	ADVANCED APP SETTINGS > [SHARE ACROSS DEVICES] & [ARCHIVE APPS] = OFF
SETTINGS > TIME & LANGUAGE >
	TYPING > TYPING INSIGHTS > [TYPING INSIGHTS] = OFF
SETTINGS > ACCESSIBILITY >
	NARRATOR > [NARRATOR] & [KEYBOARD SHORTCUT FOR NARRATOR] = OFF
	SPEECH > [VOICE ACCESS] = OFF
SETTINGS > PRIVACY & SECURITY >
	FIND MY DEVICE > [FIND MY DEVICE] = OFF
	GENERAL > [LET WEBSITES SHOW ME LOCALLY RELEVANT CONTENT BY ACCESSING MY LANGUAGE LIST] & [LET WINDOWS IMPROVE START AND SEARCH RESULTS BY TRACKING APP LAUNCHES] = OFF
	SPEECH > [ONLINE SPEECH RECOGNITION] = OFF
	INKING & TYPING PERSONALISATION > [CUSTOMISED INKING AND TYPING DICTIONARY] = OFF
	DIAGNOSTICS & FEEDBACK > ALL UNCHECKED
	SEARCH > [SEARCH MY ACCOUNTS[MICROSOFT ACCOUNT]&[WORK OR SCHOOL ACCOUNT]] & [LET SEARCH APPS SHOW RESULTS] = OFF > [FIND MY FILES] = CLASSIC
SETTINGS > WINDOWS UPDATE > 
	ADVANCED OPTIONS > [NOTIFY ME WHEN A RESTART IS REQUIRED TO FINISH UPDATING] = ON
	DELIVERY OPTIMISATION > [ALLOW DOWNLOADS FROM OTHER DEVICES] = OFF







###################
# CODE NOT WORKING
###################
<#

    foreach ($svc in $servicesToDisable) {
        if (Get-Service -Name $svc -ErrorAction SilentlyContinue) {
            try {
                Stop-Service $svc -Force -ErrorAction SilentlyContinue
                Set-Service $svc -StartupType Disabled
            } catch {
				Write-Warning "Status: Failed to set Service to Disabled $_"
			}
        }
    }

    foreach ($svc in $servicesToManual) {
        if (Get-Service -Name $svc -ErrorAction SilentlyContinue) {
            try {
                Set-Service $svc -StartupType Manual
            } catch {
				Write-Warning "Status: Failed to set Service to Manual $_"
			}
        }
    }#>
# ========================
# MICROSOFT EDGE SETTINGS (UNUSED NOT WORKING AS INTENDED)
# ========================
<#if ($edgeSettings) {
	Write-Host "Status: Defining Microsoft Edge settings... (Skipping, W.I.P.)" -ForegroundColor Cyan
	
	$edgePolicy = "HKLM:\SOFTWARE\Policies\Microsoft\Edge"
	if (-not (Test-Path $edgePolicy)) { New-Item -Path $edgePolicy -Force | Out-Null }

	# Disable sidebar and button.
	Set-ItemProperty -Path $edgePolicy -Name "HubsSidebarEnabled" -Type DWord -Value 0

	# Disable Bing Discover button.
	Set-ItemProperty -Path $edgePolicy -Name "DiscoverEnabled" -Type DWord -Value 0

	# Disable Copilot button.
	Set-ItemProperty -Path $edgePolicy -Name "CopilotButtonEnabled" -Type DWord -Value 0

	# Disable Tab Actions menu (vertical tabs, tab search, etc.)
	Set-ItemProperty -Path $edgePolicy -Name "TabServicesEnabled" -Type DWord -Value 0
	Set-ItemProperty -Path $edgePolicy -Name "TabSearchEnabled" -Type DWord -Value 0

	# Set Google as default search engine.
	Set-ItemProperty -Path $edgePolicy -Name "BingSearchEnabled" -Type DWord -Value 0

	Set-ItemProperty -Path $edgePolicy -Name "DefaultSearchProviderEnabled" -Type DWord -Value 1
	Set-ItemProperty -Path $edgePolicy -Name "DefaultSearchProviderName" -Value "Google"
	Set-ItemProperty -Path $edgePolicy -Name "DefaultSearchProviderSearchURL" -Value "https://www.google.com/search?q={searchTerms}"
	Set-ItemProperty -Path $edgePolicy -Name "DefaultSearchProviderSuggestURL" -Value "https://www.google.com/complete/search?output=chrome&q={searchTerms}"
}#>

	# Windows 11 Start Menu (removed because still needs to work on Windows 10)
	# JSON layout for Start pins
	$jsonLayout = @"
	{
	  "pinnedList": [
		{ "desktopAppId": "MSEdge" },
		{ "packagedAppId": "Microsoft.WindowsStore_8wekyb3d8bbwe!App" },
		{ "packagedAppId": "windows.immersivecontrolpanel_cw5n1h2txyewy!microsoft.windows.immersivecontrolpanel" }
	  ]
	}
"@

	$jsonPath = "$env:LOCALAPPDATA\Microsoft\Windows\Shell\LayoutModification.json"
	$jsonLayout | Out-File -FilePath $jsonPath -Encoding utf8

	$key = "HKLM:\SOFTWARE\Microsoft\PolicyManager\current\device\Start"
	if (-not (Test-Path $key)) {
		New-Item -Path $key -Force | Out-Null
	}

	Set-ItemProperty -Path $key -Name "ConfigureStartPins" -Value $jsonLayout

	$startLayoutPath = "$env:LOCALAPPDATA\Packages\Microsoft.Windows.StartMenuExperienceHost_cw5n1h2txyewy\LocalState"
	$binFile = Join-Path $startLayoutPath "start2.bin"

	if (Test-Path $binFile) {
		Stop-Process -Name "StartMenuExperienceHost" -Force -ErrorAction SilentlyContinue
		Remove-Item $binFile -Force
	} else {
		# No cache file found.
	}